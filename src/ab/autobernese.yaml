# local: &local __ab__

# Bernese GNSS Software [BSW] environment variables available after 'source'ing
# the shell script` LOADGPS.setvar` in the root of the installation directory.
bsw_env:

  # Installation directory
  C: &C !ENV [C, .]

  # Bernese program panels
  PAN: &PAN !ENV [PAN, .]

  # Global model files used by Bernese programs
  MODEL: &MODEL !ENV [MODEL, .]

  # Global configuration file used by Bernese programs
  CONFIG: &CONFIG !ENV [CONFIG, .]

  # DATAPOOL directory
  D: &D !ENV [D, .]

  # CAMPAIGN directory
  P: &P !ENV [P, .]

  # User directory
  U: &U !ENV [U, .]

# Autobernese runtime environment
environment:
  env_root: &env_root !Parent [*C]
  ab_root: &ab_root !Path [*env_root, autobernese]
  logging:
    filename: !Path [*ab_root, autobernese.log]
    format: '%(asctime)s | %(levelname)s | %(name)s | %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'
    style: '%'
    level: DEBUG

  # system_user_root: !Path [*ab_root, system_user]
  # state: !Path [*ab_root, state.yaml]
  # datafiles:
  #   sources: !Path [*ab_root, sources.yaml]

common:
# TODO: Remove test directory
- &test !Path [*D, test]

- &sitelogs !Path [*D, sitelogs]
- &station !Path [*D, station]

station:
  sitelogs: # !Path [*sitelogs, '*.log']
  - !Path [*sitelogs, esbc*.log]
  - !Path [*sitelogs, fer5*.log]
  - !Path [*sitelogs, fyha*.log]
  - !Path [*sitelogs, gesr*.log]
  - !Path [*sitelogs, haby*.log]
  - !Path [*sitelogs, hirs*.log]
  - !Path [*sitelogs, tejh*.log]
  - !Path [*sitelogs, mojn*.log]
  - !Path [*sitelogs, skej*.log]
  - !Path [*sitelogs, riko*.log]
  - !Path [*sitelogs, fyno*.log]
  - !Path [*sitelogs, esh5*.log]
  - !Path [*sitelogs, grej*.log]

  individually_calibrated: [BUDD, MOJN, RIKO]

  filename_sta: !Path [*station, sitelogs.STA]

bsw:

  campaign:
    menu: !Path [*PAN, MENU_CMP.INP]

data:

  # Download scenarier:
  #
  # 1) Download en specifik fil på en FTP-server
  #
  # 2) Download alle filer (ikke i undermapper) fra en given mappe på en
  #    FTP-server til en given destinationsmappe (indholdet, ikke i en
  #    undermappe)
  #
  # 3) Download specifik fil givet en URL via HTTP.
  #
  # 4) Download specifikke filer angivet som fulde filnavne fra en given mappe
  #    på en FTP-server. Kræver, at man lister navne på mappen op og kun tager
  #    dem, der findes.
  #
  # 5) Download specifikke filtyper fra en FTP-servermappe, hvor filerne er
  #    angivet med wildcard så som *.EPH.Z.

  sources:

  # ad.1)
  - !Source
    name: EUREF STA file
    url: ftp://epncb.oma.be/pub/station/general/EUREF52.STA
    destination: *station

  # # ad.2)
  - !Source
    name: BSW Model data
    url: ftp://ftp.aiub.unibe.ch/BSWUSER54/MODEL/
    destination: *MODEL
    # TODO: Remove debug path
    # destination: !Path [., __ab__/MODEL]

  # ad.2)
  - !Source
    name: BSW Configuration data
    url: ftp://ftp.aiub.unibe.ch/BSWUSER54/CONFIG/
    destination: *CONFIG

  # ad.3)
  - !Source
    name: TU Wien Vienna Mapping Model 3
    url: https://vmf.geo.tuwien.ac.at/trop_products/GRID/1x1/VMF3/VMF3_OP/{date.year}/VMF3_{date.year}{date.month:02d}{date.day:02d}.H{hour}
    destination: !Path [*D, test, VMF3_1x1_OP, '{date.year}']
    parameters:
      date: !DateRange
        beg: 2023-01-01
        end: 2023-01-02
      hour: ['00', '06', '12', '18']

  # ad.4)
  - !Source
    name: Universal and BSW-specific antenna files
    url: ftp://ftp.aiub.unibe.ch/BSWUSER54/REF/
    filenames:
    - ANTENNA_I14.PCV
    - ANTENNA_I20.PCV
    - I14.ATX
    - I20.ATX
    destination: !Path [*D, REF54]
    # download_rate: asdf

  # ad.5)
  # - !Source
  #   name: Ionosphere and satellite-bias files
  #   url: ftp://ftp.aiub.unibe.ch/BSWUSER54/CODE/{year}/
  #   destination: !Path [*test, CODE, '{year}']
  #   parameters:
  #     year: [2022, 2023]
  #   filenames:
  #   - '*.ION.Z'
  #   - '*.BIA'
  #   # max_age: 1
